#!/usr/bin/env node

var app = require('../app');
var debug = require('debug')('virtine-project:server');
var fs = require('fs');
var http = require('http');
var https = require('https');
var privateKey  = fs.readFileSync('ssl/server.key', 'utf8');
var certificate = fs.readFileSync('ssl/server.crt', 'utf8');

var credentials = {key: privateKey, cert: certificate};
var express = require('express');
//var app = express();

// your express configuration here

http.createServer(function (req, res) {
  console.log("salut !");
  console.log("host: " + req.headers['host']);
    if (req.headers['host'] == "corporate-memoria.com" || req.headers['host'] == "www.corporate-memoria.com") {
      console.log('coucou1');
      res.writeHead(301, { "Location": "https://www.corporate-memoria.com" + req.url });
      res.end();
    } else {
      console.log("coucou2");
      res.writeHead(301, { "Location": "https://" + req.headers['host'] + req.url });
      res.end();
    }
}, app).listen(80);

https.createServer(credentials, app).listen(443);
